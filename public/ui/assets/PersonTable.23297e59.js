var e=(e,t,n)=>new Promise(((a,i)=>{var o=e=>{try{l(n.next(e))}catch(t){i(t)}},s=e=>{try{l(n.throw(e))}catch(t){i(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,s);l((n=n.apply(e,t)).next())}));import{_ as t}from"./TableImg.e17cc06a.js";import{_ as n}from"./useForm.9f758c80.js";import{u as a}from"./useTable.a77db7eb.js";import{r as i,j as o}from"./index.886fff71.js";import{D as s,r as l,u as r,T as d,_ as c,a0 as u,H as m,J as p,z as f,a4 as b,ab as j}from"./vendor.2a694682.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./useWindowSizeFn.ba9c561c.js";import"./index.6f230b74.js";import"./useAttrs.c83a264c.js";import"./onMountedOrActivated.1cc20755.js";/* empty css              */import"./useSortable.a0d70131.js";/* empty css              *//* empty css              *//* empty css              */import"./index.159369ef.js";import"./index.08924b52.js";import"./download.24e74597.js";import"./index.52577703.js";var h=s({components:{BasicTable:t,TableAction:n},props:{columns:{type:[Array],default:()=>[]},dataSource:{type:Array,default:null},api:{type:Function,default:null},apiColumns:{type:Function,default:null}},setup(t){const n=l({editable:!0,isNew:!0}),s=l(),u=l();t.columns.map((function(e){Object.assign(r(n),{[e.dataIndex]:""})})),d((()=>t),(e=>{const{columns:n,apiColumns:a,api:i,dataSource:o}=t;!a&&n&&(u.value=n),!i&&o&&(s.value=o),v()}),{immediate:!0,deep:!0}),d((()=>t.api),(e=>{const{columns:n,apiColumns:a,api:i,dataSource:o}=t;!a&&n&&(u.value=n),!i&&o&&(s.value=o),v()}),{immediate:!0,deep:!0}),d((()=>t.apiColumns),(()=>e(this,null,(function*(){const{apiColumns:e}=t;try{if(e&&o(e)){let t={};const n=yield e(t);b(n)}}catch(n){}}))),{immediate:!0,deep:!0});const[m,{getDataSource:p,setTableData:f,setProps:b,setColumns:j}]=a({showIndexColumn:!1,actionColumn:{width:160,title:"操作",dataIndex:"action",slots:{customRender:"action"}},pagination:!1});function h(e){var t;null==(t=e.onEdit)||t.call(e,!0)}function x(e){var t;if(null==(t=e.onEdit)||t.call(e,!1),e.isNew){const t=p(),n=t.findIndex((t=>t.key===e.key));t.splice(n,1)}}function C(e){var t;null==(t=e.onEdit)||t.call(e,!1,!0)}function v(){return e(this,null,(function*(){const{api:e}=t;try{if(e&&o(e)){let t={};yield e(t)}}catch(n){}}))}return c((()=>{i((()=>{v()}),16)})),{registerTable:m,dataRef:s,columnRef:u,handleEdit:h,createActions:function(e,t){return e.editable?[{label:"保存",onClick:C.bind(null,e,t)},{label:"取消",popConfirm:{title:"是否取消编辑",confirm:x.bind(null,e,t)}}]:[{label:"编辑",onClick:h.bind(null,e)},{label:"删除"}]},handleAdd:function(){p().push(r(n))},getDataSource:p,setTableData:f,setProps:b,setColumns:j,handleEditChange:function(e){}}}});const x=j(" 新增规格 ");h.render=function(e,t,n,a,i,o){const s=u("a-button"),l=u("TableAction"),r=u("BasicTable");return m(),p("div",null,[f(s,{block:"",class:"mt-5",type:"dashed",onClick:e.handleAdd},{default:b((()=>[x])),_:1},8,["onClick"]),f(r,{onRegister:e.registerTable,onEditChange:e.handleEditChange},{action:b((({record:t,column:n})=>[f(l,{actions:e.createActions(t,n)},null,8,["actions"])])),_:1},8,["onRegister","onEditChange"])])};export{h as default};
