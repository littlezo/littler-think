var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{Input as o,Tag as i,Radio as u}from"ant-design-vue";import{P as d}from"./index.94fd9752.js";import{A as p,N as c,bc as m,af as g,j as v,T as y,Z as f,F as h,G as _,a1 as b,x as w,a7 as x,K as O,H as j,J as N,a5 as T,ah as k,a6 as P}from"./vendor.ecc5e6ce.js";import{u as L,aK as C}from"./index.85303d5a.js";import"./onMountedOrActivated.6e7c6753.js";import"./useWindowSizeFn.1b287cdc.js";import"./useContentViewHeight.a7e7747f.js";var I=p({components:{PageWrapper:d,[o.name]:o,InputTextArea:o.TextArea,Tag:i,RadioButton:u.Button,RadioGroup:u.Group},setup(){const e=L(),o=c({server:"",sendValue:"",target:"",event:"",type:1,msg_type:0,recordList:[]});var i,u,d;o.server||(o.server=(null!=(i=null==e?void 0:e.wsUrl)?i:"ws://localhost")+":"+(null!=(u=null==e?void 0:e.wsPort)?u:9520)+(null!=(d=null==e?void 0:e.wsPrefix)?d:""));o.server;const{status:p,data:f,send:h,close:_,open:b}=m(o.server,{autoReconnect:!1,heartbeat:{message:'0500000000340000000001000"PING"END',interval:3e4}});g((()=>{if(f.value)try{const e=f.value,t=e.substr(12,10),a=e.substr(Number(t)+22,2),l=e.slice(Number(t)+24+Number(a),e.length-3);o.recordList.push({target_length:t,event_length:a,body_length:e.length,original:f.value,res:JSON.parse(l),type:1,id:Math.ceil(Math.random()+o.recordList.length),time:(new Date).getTime()})}catch(e){o.recordList.push({target_length:0,event_length:0,type:1,body_length:f.value.length,original:f.value,res:JSON.stringify(f.value,null,4),id:Math.ceil(Math.random()+o.recordList.length),time:(new Date).getTime()})}}));const w=v((()=>"OPEN"===p.value)),x=v((()=>w.value?"success":"red")),O=v((()=>o.recordList.length?[...o.recordList].reverse():[]));function j(e,t){for(var a in t)if(t[a]==e)return!0;return!1}function N(e,t){return(Array(t).join("0")+e).slice(-t)}function T(){const e=N(o.type,2),t=N(0===o.type?1:0,2),a=j(e,[0,3,4,5])?"0":o.target,l=o.event,s=N(a.length,10),r=N(l.length,2);let n=o.sendValue.replace(/[\n|\r|\s]/gim,"");n=JSON.stringify(n);const i=N((e+t+"00000000"+s+a+r+l+n).length+3,8),u=e+t+i+s+a+r+l+n+"END";return o.recordList.push({target_length:s,event_length:r,body_length:i,res:JSON.parse(n),original:u,type:0,id:Math.ceil(Math.random()+o.recordList.length),time:(new Date).getTime()}),u}return k=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&n(e,a,t[a]);if(l)for(var a of l(t))r.call(t,a)&&n(e,a,t[a]);return e})({status:p,switch_msg_type:e=>{j(e,[0,1])?o.msg_type=e:o.recordList=[]},formatToDateTime:C},y(o)),t(k,a({handlerSend:function(){h(T())},getList:O,toggle:function(){w.value?_():b()},str_pad:N,in_array:j,pack:T,getIsOpen:w,getTagColor:x}));var k}});const S={class:"flex"},D={class:"w-1/3 p-4 bg-white"},A={class:"flex items-center"},G=w("span",{class:"mr-4 text-lg font-medium"},"连接状态:",-1),M=w("hr",{class:"my-4"},null,-1),U={class:"flex"},J=x("服务地址"),R=w("p",{class:"mt-4 text-lg font-medium"},"消息类型",-1),V=w("hr",{class:"my-4"},null,-1),B=x(" 服务调度 "),E=x(" 消息 "),W=x(" 同步SYN "),K=x(" 回复ACK "),F=x(" PONG "),H=x(" PING "),z=w("p",{class:"mt-4 text-lg font-medium"},"发送目标",-1),Y=w("hr",{class:"my-4"},null,-1),Z=w("p",{class:"mt-4 text-lg font-medium"},"调取服务",-1),q=w("hr",{class:"my-4"},null,-1),Q=w("p",{class:"mt-4 text-lg font-medium"},"发送内容或参数",-1),X=w("hr",{class:"my-4"},null,-1),$=x("发送"),ee={class:"w-2/3 p-4 ml-4 bg-white"},te=w("span",{class:"mr-4 text-lg font-medium"},"消息记录:",-1),ae=x("解析消息"),le=x("原始消息"),se=x("清空消息记录"),re=w("hr",{class:"my-4"},null,-1),ne={class:"overflow-auto max-h-80"},oe={class:"flex items-center"},ie=w("span",{class:"mr-2 font-medium text-pink-900"}," 包长:",-1),ue={key:0},de={class:"json"},pe={key:1};I.render=function(e,t,a,l,s,r){const n=f("Tag"),o=f("a-input"),i=f("a-button"),u=f("RadioButton"),d=f("RadioGroup"),p=f("InputTextArea"),c=f("PageWrapper");return h(),_(c,{title:"WebSocket 调试工具"},{default:b((()=>[w("div",S,[w("div",D,[w("div",A,[G,w(n,{color:e.getTagColor},{default:b((()=>[x(O(e.status),1)])),_:1},8,["color"])]),M,w("div",U,[w(o,{value:e.server,"onUpdate:value":t[1]||(t[1]=t=>e.server=t),disabled:""},{addonBefore:b((()=>[J])),_:1},8,["value"]),w(i,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle},{default:b((()=>[x(O(e.getIsOpen?"关闭连接":"开启连接"),1)])),_:1},8,["type","onClick"])]),R,V,w(d,{"button-style":"solid",value:e.type,"onUpdate:value":t[2]||(t[2]=t=>e.type=t)},{default:b((()=>[w(u,{value:0},{default:b((()=>[B])),_:1}),w(u,{value:1},{default:b((()=>[E])),_:1}),w(u,{value:2},{default:b((()=>[W])),_:1}),w(u,{value:3},{default:b((()=>[K])),_:1}),w(u,{value:4},{default:b((()=>[F])),_:1}),w(u,{value:5},{default:b((()=>[H])),_:1})])),_:1},8,["value"]),z,Y,w(o,{value:e.target,"onUpdate:value":t[3]||(t[3]=t=>e.target=t),disabled:e.in_array(e.type,[0,3,4,5]),placeholder:"默认自己"},null,8,["value","disabled"]),Z,q,w(o,{value:e.event,"onUpdate:value":t[4]||(t[4]=t=>e.event=t),disabled:0!==e.type,placeholder:"调取事件"},null,8,["value","disabled"]),Q,X,w(p,{placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,value:e.sendValue,"onUpdate:value":t[5]||(t[5]=t=>e.sendValue=t),allowClear:""},null,8,["disabled","value"]),w(i,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:b((()=>[$])),_:1},8,["disabled","onClick"])]),w("div",ee,[te,w(i,{type:0===e.msg_type?"primary":"",onClick:t[6]||(t[6]=t=>e.switch_msg_type(0))},{default:b((()=>[ae])),_:1},8,["type"]),w(i,{type:1===e.msg_type?"primary":"",onClick:t[7]||(t[7]=t=>e.switch_msg_type(1))},{default:b((()=>[le])),_:1},8,["type"]),w(i,{type:2===e.msg_type?"primary":"",onClick:t[8]||(t[8]=t=>e.switch_msg_type(2))},{default:b((()=>[se])),_:1},8,["type"]),re,w("div",ne,[j(w("ul",null,[(h(!0),_(T,null,k(e.getList,(t=>(h(),_("li",{class:"mt-2",key:t.time},[w("div",oe,[w("span",{class:["mr-2 font-medium",0===t.type?"text-primary":"text-green-900"]},O(0===t.type?"发送消息:":"收到消息:"),3),w("span",null,O(e.formatToDateTime(t.time)),1),ie,w("span",null,O(t.body_length),1)]),0==e.msg_type?(h(),_("div",ue,[w("pre",null,[w("code",de,O(t.res),1)])])):P("",!0),1==e.msg_type?(h(),_("div",pe,O(t.original),1)):P("",!0)])))),128))],512),[[N,e.recordList.length]])])])])])),_:1})};export{I as default};
