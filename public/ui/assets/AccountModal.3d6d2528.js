var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,n=(e,t,a)=>new Promise(((o,r)=>{var n=e=>{try{i(a.next(e))}catch(t){r(t)}},l=e=>{try{i(a.throw(e))}catch(t){r(t)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,l);i((a=a.apply(e,t)).next())}));import{B as l,b as i}from"./index.6f230b74.js";import{g as s,h as d}from"./useForm.9f758c80.js";import{a as c,b as p}from"./index.7b0adf1e.js";import{D as u,r as m,u as f,j as b,m as h,a0 as g,H as w,J as v,a4 as y,z as I,a3 as _}from"./vendor.2a694682.js";import{aN as x,aO as P}from"./index.886fff71.js";const j=[{title:"用户名",dataIndex:"username",width:120},{title:"真实姓名",dataIndex:"real_name",width:120},{title:"手机号",dataIndex:"mobile",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"create_time",width:180},{title:"角色",dataIndex:"roles_ids",width:200},{title:"备注",dataIndex:"remark"}],O=[{field:"like_username",label:"用户名",component:"Input",colProps:{span:8}},{field:"like_real_name",label:"真实姓名",component:"Input",colProps:{span:8}},{field:"like_mobile",label:"手机号",component:"Input",colProps:{span:8}}],S=[{field:"username",label:"用户名",component:"Input",required:!0},{field:"password",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"roles_ids",component:"ApiSelect",componentProps:{api:c,labelField:"name",valueField:"id"},required:!0},{field:"dept_ids",label:"所属部门",component:"TreeSelect",componentProps:{replaceFields:{title:"name",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"real_name",label:"真实姓名",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"手机号",field:"mobile",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}];var F=u({name:"AccountModal",components:{BasicModal:l,BasicForm:s},emits:["success","register"],setup(e,{emit:l}){const s=m(!0),c=m(0),[u,{setFieldsValue:g,updateSchema:w,resetFields:v,validate:y}]=d({labelWidth:100,schemas:S,showActionButtonGroup:!1,actionColOptions:{span:23}}),[I,{setModalProps:_,closeModal:j}]=i((e=>n(this,null,(function*(){v(),_({confirmLoading:!1}),s.value=!!(null==e?void 0:e.isUpdate),f(s)&&(c.value=e.record.id,g(((e,n)=>{for(var l in n||(n={}))a.call(n,l)&&r(e,l,n[l]);if(t)for(var l of t(n))o.call(n,l)&&r(e,l,n[l]);return e})({},e.record)));const n=yield p();w([{field:"password",ifShow:!0,required:!f(s)},{field:"dept_ids",componentProps:{treeData:n}}])}))));return{registerModal:I,registerForm:u,getTitle:b((()=>f(s)?"编辑账号":"新增账号")),handleSubmit:function(){return n(this,null,(function*(){try{const e=yield y();_({confirmLoading:!0}),e.password&&(e.password=h(h(e.password)).toString()),f(s)?x("/user/account",c.value,e).then((e=>{j(),l("success")})):P("/user/account",e).then((e=>{l("success")}))}finally{_({confirmLoading:!1})}}))}}}});F.render=function(e,t,a,o,r,n){const l=g("BasicForm"),i=g("BasicModal");return w(),v(i,_(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:y((()=>[I(l,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var k=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:F});export{k as A,F as _,j as c,O as s};
