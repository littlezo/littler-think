var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{D as i,am as o,bH as u,bC as d,Q as p,c0 as c,ak as m,j as g,X as v,a0 as y,H as f,J as h,a4 as b,z as _,ab as x,N as w,K as O,L as j,a9 as k,aq as N,aa as L}from"./vendor.2a694682.js";/* empty css              *//* empty css              */import{P}from"./index.c2001bf3.js";import{u as T,aK as C}from"./index.886fff71.js";/* empty css              *//* empty css              */import"./onMountedOrActivated.1cc20755.js";import"./useWindowSizeFn.ba9c561c.js";import"./useContentViewHeight.12ec88be.js";var I=i({components:{PageWrapper:P,[o.name]:o,InputTextArea:o.TextArea,Tag:u,RadioButton:d.Button,RadioGroup:d.Group},setup(){const e=T(),i=p({server:"",sendValue:"",target:"",event:"",type:1,msg_type:0,recordList:[]});var o,u,d;i.server||(i.server=(null!=(o=null==e?void 0:e.wsUrl)?o:"ws://localhost")+":"+(null!=(u=null==e?void 0:e.wsPort)?u:9520)+(null!=(d=null==e?void 0:e.wsPrefix)?d:""));i.server;const{status:y,data:f,send:h,close:b,open:_}=c(i.server,{autoReconnect:!1,heartbeat:{message:'0500000000340000000001000"PING"END',interval:3e4}});m((()=>{if(f.value)try{const e=f.value,t=e.substr(12,10),a=e.substr(Number(t)+22,2),l=e.slice(Number(t)+24+Number(a),e.length-3);i.recordList.push({target_length:t,event_length:a,body_length:e.length,original:f.value,res:JSON.parse(l),type:1,id:Math.ceil(Math.random()+i.recordList.length),time:(new Date).getTime()})}catch(e){i.recordList.push({target_length:0,event_length:0,type:1,body_length:f.value.length,original:f.value,res:JSON.stringify(f.value,null,4),id:Math.ceil(Math.random()+i.recordList.length),time:(new Date).getTime()})}}));const x=g((()=>"OPEN"===y.value)),w=g((()=>x.value?"success":"red")),O=g((()=>i.recordList.length?[...i.recordList].reverse():[]));function j(e,t){for(var a in t)if(t[a]==e)return!0;return!1}function k(e,t){return(Array(t).join("0")+e).slice(-t)}function N(){const e=k(i.type,2),t=k(0===i.type?1:0,2),a=j(e,[0,3,4,5])?"0":i.target,l=i.event,s=k(a.length,10),r=k(l.length,2);let n=i.sendValue.replace(/[\n|\r|\s]/gim,"");n=JSON.stringify(n);const o=k((e+t+"00000000"+s+a+r+l+n).length+3,8),u=e+t+o+s+a+r+l+n+"END";return i.recordList.push({target_length:s,event_length:r,body_length:o,res:JSON.parse(n),original:u,type:0,id:Math.ceil(Math.random()+i.recordList.length),time:(new Date).getTime()}),u}return L=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&n(e,a,t[a]);if(l)for(var a of l(t))r.call(t,a)&&n(e,a,t[a]);return e})({status:y,switch_msg_type:e=>{j(e,[0,1])?i.msg_type=e:i.recordList=[]},formatToDateTime:C},v(i)),t(L,a({handlerSend:function(){h(N())},getList:O,toggle:function(){x.value?b():_()},str_pad:k,in_array:j,pack:N,getIsOpen:x,getTagColor:w}));var L}});const S={class:"flex"},D={class:"w-1/3 p-4 bg-white"},M={class:"flex items-center"},A=_("span",{class:"mr-4 text-lg font-medium"},"连接状态:",-1),G=_("hr",{class:"my-4"},null,-1),U={class:"flex"},J=x("服务地址"),R=_("p",{class:"mt-4 text-lg font-medium"},"消息类型",-1),V=_("hr",{class:"my-4"},null,-1),B=x(" 服务调度 "),E=x(" 消息 "),W=x(" 同步SYN "),H=x(" 回复ACK "),K=x(" PONG "),z=x(" PING "),q=_("p",{class:"mt-4 text-lg font-medium"},"发送目标",-1),F=_("hr",{class:"my-4"},null,-1),Q=_("p",{class:"mt-4 text-lg font-medium"},"调取服务",-1),X=_("hr",{class:"my-4"},null,-1),Y=_("p",{class:"mt-4 text-lg font-medium"},"发送内容或参数",-1),Z=_("hr",{class:"my-4"},null,-1),$=x("发送"),ee={class:"w-2/3 p-4 ml-4 bg-white"},te=_("span",{class:"mr-4 text-lg font-medium"},"消息记录:",-1),ae=x("解析消息"),le=x("原始消息"),se=x("清空消息记录"),re=_("hr",{class:"my-4"},null,-1),ne={class:"overflow-auto max-h-80"},ie={class:"flex items-center"},oe=_("span",{class:"mr-2 font-medium text-pink-900"}," 包长:",-1),ue={key:0},de={class:"json"},pe={key:1};I.render=function(e,t,a,l,s,r){const n=y("Tag"),i=y("a-input"),o=y("a-button"),u=y("RadioButton"),d=y("RadioGroup"),p=y("InputTextArea"),c=y("PageWrapper");return f(),h(c,{title:"WebSocket 调试工具"},{default:b((()=>[_("div",S,[_("div",D,[_("div",M,[A,_(n,{color:e.getTagColor},{default:b((()=>[x(w(e.status),1)])),_:1},8,["color"])]),G,_("div",U,[_(i,{value:e.server,"onUpdate:value":t[1]||(t[1]=t=>e.server=t),disabled:""},{addonBefore:b((()=>[J])),_:1},8,["value"]),_(o,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle},{default:b((()=>[x(w(e.getIsOpen?"关闭连接":"开启连接"),1)])),_:1},8,["type","onClick"])]),R,V,_(d,{"button-style":"solid",value:e.type,"onUpdate:value":t[2]||(t[2]=t=>e.type=t)},{default:b((()=>[_(u,{value:0},{default:b((()=>[B])),_:1}),_(u,{value:1},{default:b((()=>[E])),_:1}),_(u,{value:2},{default:b((()=>[W])),_:1}),_(u,{value:3},{default:b((()=>[H])),_:1}),_(u,{value:4},{default:b((()=>[K])),_:1}),_(u,{value:5},{default:b((()=>[z])),_:1})])),_:1},8,["value"]),q,F,_(i,{value:e.target,"onUpdate:value":t[3]||(t[3]=t=>e.target=t),disabled:e.in_array(e.type,[0,3,4,5]),placeholder:"默认自己"},null,8,["value","disabled"]),Q,X,_(i,{value:e.event,"onUpdate:value":t[4]||(t[4]=t=>e.event=t),disabled:0!==e.type,placeholder:"调取事件"},null,8,["value","disabled"]),Y,Z,_(p,{placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,value:e.sendValue,"onUpdate:value":t[5]||(t[5]=t=>e.sendValue=t),allowClear:""},null,8,["disabled","value"]),_(o,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:b((()=>[$])),_:1},8,["disabled","onClick"])]),_("div",ee,[te,_(o,{type:0===e.msg_type?"primary":"",onClick:t[6]||(t[6]=t=>e.switch_msg_type(0))},{default:b((()=>[ae])),_:1},8,["type"]),_(o,{type:1===e.msg_type?"primary":"",onClick:t[7]||(t[7]=t=>e.switch_msg_type(1))},{default:b((()=>[le])),_:1},8,["type"]),_(o,{type:2===e.msg_type?"primary":"",onClick:t[8]||(t[8]=t=>e.switch_msg_type(2))},{default:b((()=>[se])),_:1},8,["type"]),re,_("div",ne,[O(_("ul",null,[(f(!0),h(k,null,N(e.getList,(t=>(f(),h("li",{class:"mt-2",key:t.time},[_("div",ie,[_("span",{class:["mr-2 font-medium",0===t.type?"text-primary":"text-green-900"]},w(0===t.type?"发送消息:":"收到消息:"),3),_("span",null,w(e.formatToDateTime(t.time)),1),oe,_("span",null,w(t.body_length),1)]),0==e.msg_type?(f(),h("div",ue,[_("pre",null,[_("code",de,w(t.res),1)])])):L("",!0),1==e.msg_type?(f(),h("div",pe,w(t.original),1)):L("",!0)])))),128))],512),[[j,e.recordList.length]])])])])])),_:1})};export{I as default};
