import{e as t,j as e,c as n,w as a}from"./index.85303d5a.js";import{Button as u}from"ant-design-vue";import{N as s,O as o,af as r,j as l,aF as i,Y as c,t as d,u as v,aa as f,r as p,a9 as m,A as y,Z as C,F as g,G as S,a1 as x,a7 as b,K as h,a0 as w,aq as F,ah as z,a3 as A,x as B}from"./vendor.ecc5e6ce.js";function j(t,e="value",n="change",a){const u=f(),p=null==u?void 0:u.emit,m=s({value:t[e]}),y=o(m);r((()=>{m.value=t[e]}));return[l({get:()=>m.value,set(t){i(t,y.value)||(m.value=t,c((()=>{null==p||p(n,t,...d(v(a))||[])})))}}),t=>{m.value=t},y]}var N=y({name:"CountButton",components:{Button:u},props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(n){const a=p(!1),{currentCount:u,isStart:s,start:o,reset:i}=function(t){const e=p(t),n=p(!1);let a;function u(){a&&window.clearInterval(a)}function s(){n.value=!1,u(),a=null}function o(){v(n)||a||(n.value=!0,a=setInterval((()=>{1===v(e)?(s(),e.value=t):e.value-=1}),1e3))}function r(){e.value=t,s()}return m((()=>{r()})),{start:o,reset:r,restart:function(){r(),o()},clear:u,stop:s,currentCount:e,isStart:n}}(n.count),{t:c}=t(),d=l((()=>v(s)?c("component.countdown.sendText",[v(u)]):c("component.countdown.normalText")));return r((()=>{void 0===n.value&&i()})),{handleStart:function(){return t=this,u=null,s=function*(){const{beforeStartFunc:t}=n;if(t&&e(t)){a.value=!0;try{(yield t())&&o()}finally{a.value=!1}}else o()},new Promise(((e,n)=>{var a=t=>{try{r(s.next(t))}catch(e){n(e)}},o=t=>{try{r(s.throw(t))}catch(e){n(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,o);r((s=s.apply(t,u)).next())}));var t,u,s},currentCount:u,loading:a,getButtonText:d,isStart:s}}});N.render=function(t,e,n,a,u,s){const o=C("Button");return g(),S(o,w(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:x((()=>[b(h(t.getButtonText),1)])),_:1},16,["disabled","onClick","loading"])};var T=y({name:"CountDownInput",components:{CountButton:N},inheritAttrs:!1,props:{value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:e}=n("countdown-input"),[a]=j(t);return{prefixCls:e,state:a}}});T.render=function(t,e,n,a,u,s){const o=C("CountButton"),r=C("a-input");return g(),S(r,w(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),F({addonAfter:x((()=>[B(o,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:2},[z(Object.keys(t.$slots).filter((t=>"addonAfter"!==t)),(e=>({name:e,fn:x((n=>[A(t.$slots,e,n)]))})))]),1040,["class","size","value"])};const $=a(T);a(N);export{$ as C,j as u};
