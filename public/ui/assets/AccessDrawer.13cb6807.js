var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(t,o,l)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l,s=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&r(e,o,t[o]);if(l)for(var o of l(t))n.call(t,o)&&r(e,o,t[o]);return e},i=(e,t,o)=>new Promise(((l,a)=>{var n=e=>{try{s(o.next(e))}catch(t){a(t)}},r=e=>{try{s(o.throw(e))}catch(t){a(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,r);s((o=o.apply(e,t)).next())}));import{g as p,h as u}from"./useForm.137eb3b0.js";import{Tag as d}from"ant-design-vue";import{_ as c,ae as m,aN as b,aO as f}from"./index.85303d5a.js";import{ac as v,A as h,r as y,u as g,j as w,Z as P,F as I,G as x,a1 as O,x as F,a0 as R}from"./vendor.ecc5e6ce.js";import{B as _,a as j}from"./index.45c45527.js";const B=[{title:"菜单标题",dataIndex:"title",width:200,align:"left"},{title:"菜单名称",dataIndex:"name",width:200,align:"left"},{title:"图标",dataIndex:"icon",width:50,customRender:({record:e})=>v(c,{icon:e.icon})},{title:"权限标识",dataIndex:"permission",width:180},{title:"按钮",dataIndex:"button",width:130,slots:{customRender:"button"}},{title:"组件",dataIndex:"component"},{title:"排序",dataIndex:"sort",width:50},{title:"状态",dataIndex:"status",width:80,customRender:({record:e})=>{const t=1==~~e.status,o=t?"启用":"停用";return v(d,{color:t?"green":"red"},(()=>o))}},{title:"创建时间",dataIndex:"create_time",width:180}],k=e=>0===e,q=e=>1===e,A=e=>2===e,S=[{field:"name",label:"菜单名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"停用",value:0}]},colProps:{span:8}}],V=[{field:"type",label:"菜单类型",component:"RadioButtonGroup",defaultValue:0,componentProps:({formModel:e})=>(e.component=k(e.type)?"LAYOUT":q(e.type)?"USE_TABLE":"",{options:[{label:"目录",value:0},{label:"菜单",value:1},{label:"按钮",value:2}],colProps:{lg:24,md:24}})},{field:"module",label:"模块",component:"ApiSelect",required:!0,show:({values:e})=>k(e.type),componentProps:({formModel:e})=>({labelField:"title",valueField:"module",api:e=>m("get","/user/access/module",e),getPopupContainer:()=>document.body,onChange:(t,o)=>{e.title=o.label,e.name=o.key,e.permission=o.permission,e.path="/"+o.name}})},{field:"api_select",label:"绑定操作",component:"ApiTreeSelect",required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),defaultValue:0,componentProps:({formModel:e})=>({replaceFields:{title:"title",key:"key",value:"key"},treeCheckStrictly:!1,api:e=>m("get","/user/access/module",e),getPopupContainer:()=>document.body,onChange:(t,o,l)=>{const a=l.triggerNode.dataRef;a.api?(e.title=a.title,e.name=a.key,e.api=a.api,e.method=a.method,e.permission=a.permission,e.path=a.name,e.module=a.module):e.api=""}})},{field:"title",label:"菜单标题",component:"Input",required:!0},{field:"name",label:"菜单名称",component:"Input",required:!0},{field:"api",label:"API地址",component:"Input",required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),componentProps:{disabled:!0}},{field:"parent",label:"上级菜单",component:"ApiTreeSelect",defaultValue:0,required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),componentProps:{replaceFields:{title:"title",key:"id",value:"id"},api:e=>{return m("get","/user/access/List",(l=s({},e),t(l,o({order:"asc"}))));var l},getPopupContainer:()=>document.body}},{field:"permission",label:"权限标识",component:"Input",required:!0,componentProps:{disabled:!0}},{field:"method",label:"请求方法",component:"Input",required:({values:e})=>!k(e.type),componentProps:{disabled:!0},show:({values:e})=>!k(e.type)},{field:"path",label:"路由地址",component:"Input",required:({values:e})=>!A(e.type),componentProps:({formModel:e})=>({disabled:!e.is_ext}),show:({values:e})=>!A(e.type)},{field:"component",label:"组件",component:"Input",defaultValue:"LAYOUT",show:({values:e})=>!A(e.type),componentProps:{disabled:!0}},{field:"sort",label:"排序",component:"InputNumber",defaultValue:100,required:!0},{field:"icon",label:"图标",component:"IconPicker",required:({values:e})=>!A(e.type),show:({values:e})=>!A(e.type)},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},{field:"is_ext",label:"是否外链",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>!A(e.type)},{field:"keepalive",label:"是否缓存",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>q(e.type)},{field:"is_hide",label:"是否隐藏",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>!A(e.type)}];var D=h({name:"AccessDrawer",components:{BasicDrawer:_,BasicForm:p},emits:["success","register"],setup(e,{emit:t}){const o=y(!0),l=y(0),[a,{resetFields:n,setFieldsValue:r,validate:p}]=u({labelWidth:100,schemas:V,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[d,{setDrawerProps:c,closeDrawer:m}]=j((e=>i(this,null,(function*(){n(),c({confirmLoading:!1}),o.value=!!(null==e?void 0:e.isUpdate),g(o)&&(l.value=e.record.id,r(s({},e.record)))}))));return{registerDrawer:d,registerForm:a,getTitle:w((()=>g(o)?"编辑菜单":"新增菜单")),handleSubmit:function(){return i(this,null,(function*(){try{const e=yield p();c({confirmLoading:!0}),g(o)?b("/user/access",l.value,e).then((e=>{m(),t("success")})):f("/user/access",e).then((e=>{t("success")})),t("success")}finally{c({confirmLoading:!1})}}))}}}});D.render=function(e,t,o,l,a,n){const r=P("BasicForm"),s=P("BasicDrawer");return I(),x(s,R(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"50%",onOk:e.handleSubmit}),{default:O((()=>[F(r,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var T=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:D});export{T as A,D as _,B as c,S as s};
