var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,r=(e,t)=>{for(var o in t||(t={}))l.call(t,o)&&s(e,o,t[o]);if(a)for(var o of a(t))n.call(t,o)&&s(e,o,t[o]);return e},i=(e,t,o)=>new Promise(((a,l)=>{var n=e=>{try{r(o.next(e))}catch(t){l(t)}},s=e=>{try{r(o.throw(e))}catch(t){l(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,s);r((o=o.apply(e,t)).next())}));import{g as p,h as u}from"./useForm.9f758c80.js";import{ah as d,bH as c,D as m,r as b,u as f,j as v,a0 as h,H as y,J as g,a4 as w,z as P,a3 as I}from"./vendor.2a694682.js";/* empty css              */import{_ as x,ae as O,aN as j,aO as R}from"./index.886fff71.js";import{B as _,a as B}from"./index.8bc7383a.js";const F=[{title:"菜单标题",dataIndex:"title",width:200,align:"left"},{title:"菜单名称",dataIndex:"name",width:200,align:"left"},{title:"图标",dataIndex:"icon",width:50,customRender:({record:e})=>d(x,{icon:e.icon})},{title:"权限标识",dataIndex:"permission",width:180},{title:"按钮",dataIndex:"button",width:130,slots:{customRender:"button"}},{title:"组件",dataIndex:"component"},{title:"排序",dataIndex:"sort",width:50},{title:"状态",dataIndex:"status",width:80,customRender:({record:e})=>{const t=1==~~e.status,o=t?"启用":"停用";return d(c,{color:t?"green":"red"},(()=>o))}},{title:"创建时间",dataIndex:"create_time",width:180}],k=e=>0===e,q=e=>1===e,S=e=>2===e,A=[{field:"name",label:"菜单名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"停用",value:0}]},colProps:{span:8}}],V=[{field:"type",label:"菜单类型",component:"RadioButtonGroup",defaultValue:0,componentProps:({formModel:e})=>(e.component=k(e.type)?"LAYOUT":q(e.type)?"USE_TABLE":"",{options:[{label:"目录",value:0},{label:"菜单",value:1},{label:"按钮",value:2}],colProps:{lg:24,md:24}})},{field:"module",label:"模块",component:"ApiSelect",required:!0,show:({values:e})=>k(e.type),componentProps:({formModel:e})=>({labelField:"title",valueField:"module",api:e=>O("get","/user/access/module",e),getPopupContainer:()=>document.body,onChange:(t,o)=>{e.title=o.label,e.name=o.key,e.permission=o.permission,e.path="/"+o.name}})},{field:"api_select",label:"绑定操作",component:"ApiTreeSelect",required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),defaultValue:0,componentProps:({formModel:e})=>({replaceFields:{title:"title",key:"key",value:"key"},treeCheckStrictly:!1,api:e=>O("get","/user/access/module",e),getPopupContainer:()=>document.body,onChange:(t,o,a)=>{const l=a.triggerNode.dataRef;l.api?(e.title=l.title,e.name=l.key,e.api=l.api,e.method=l.method,e.permission=l.permission,e.path=l.name,e.module=l.module):e.api=""}})},{field:"title",label:"菜单标题",component:"Input",required:!0},{field:"name",label:"菜单名称",component:"Input",required:!0},{field:"api",label:"API地址",component:"Input",required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),componentProps:{disabled:!0}},{field:"parent",label:"上级菜单",component:"ApiTreeSelect",defaultValue:0,required:({values:e})=>!k(e.type),show:({values:e})=>!k(e.type),componentProps:{replaceFields:{title:"title",key:"id",value:"id"},api:e=>{return O("get","/user/access/List",(a=r({},e),t(a,o({order:"asc"}))));var a},getPopupContainer:()=>document.body}},{field:"permission",label:"权限标识",component:"Input",required:!0,componentProps:{disabled:!0}},{field:"method",label:"请求方法",component:"Input",required:({values:e})=>!k(e.type),componentProps:{disabled:!0},show:({values:e})=>!k(e.type)},{field:"path",label:"路由地址",component:"Input",required:({values:e})=>!S(e.type),componentProps:({formModel:e})=>({disabled:!e.is_ext}),show:({values:e})=>!S(e.type)},{field:"component",label:"组件",component:"Input",defaultValue:"LAYOUT",show:({values:e})=>!S(e.type),componentProps:{disabled:!0}},{field:"sort",label:"排序",component:"InputNumber",defaultValue:100,required:!0},{field:"icon",label:"图标",component:"IconPicker",required:({values:e})=>!S(e.type),show:({values:e})=>!S(e.type)},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},{field:"is_ext",label:"是否外链",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>!S(e.type)},{field:"keepalive",label:"是否缓存",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>q(e.type)},{field:"is_hide",label:"是否隐藏",component:"RadioButtonGroup",defaultValue:0,componentProps:{options:[{label:"否",value:0},{label:"是",value:1}]},show:({values:e})=>!S(e.type)}];var D=m({name:"AccessDrawer",components:{BasicDrawer:_,BasicForm:p},emits:["success","register"],setup(e,{emit:t}){const o=b(!0),a=b(0),[l,{resetFields:n,setFieldsValue:s,validate:p}]=u({labelWidth:100,schemas:V,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[d,{setDrawerProps:c,closeDrawer:m}]=B((e=>i(this,null,(function*(){n(),c({confirmLoading:!1}),o.value=!!(null==e?void 0:e.isUpdate),f(o)&&(a.value=e.record.id,s(r({},e.record)))}))));return{registerDrawer:d,registerForm:l,getTitle:v((()=>f(o)?"编辑菜单":"新增菜单")),handleSubmit:function(){return i(this,null,(function*(){try{const e=yield p();c({confirmLoading:!0}),f(o)?j("/user/access",a.value,e).then((e=>{m(),t("success")})):R("/user/access",e).then((e=>{t("success")})),t("success")}finally{c({confirmLoading:!1})}}))}}}});D.render=function(e,t,o,a,l,n){const s=h("BasicForm"),r=h("BasicDrawer");return y(),g(r,I(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"50%",onOk:e.handleSubmit}),{default:w((()=>[P(s,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var T=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:D});export{T as A,D as _,F as c,A as s};
